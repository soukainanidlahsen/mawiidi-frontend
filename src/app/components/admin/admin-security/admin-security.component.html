<div class="security-page">
    <header class="page-header">
        <h1>Security & Compliance</h1>
        <p>Access logs, GDPR compliance, and security monitoring</p>
    </header>

    <div class="tabs">
        <button [class.active]="activeTab === 'logs'" (click)="setTab('logs')">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" x2="8" y1="13" y2="13" />
                <line x1="16" x2="8" y1="17" y2="17" />
            </svg>
            Access Logs
        </button>
        <button [class.active]="activeTab === 'patient-access'" (click)="setTab('patient-access')">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
                <path d="M15 2H9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z" />
            </svg>
            Patient Record Access
        </button>
        <button [class.active]="activeTab === 'gdpr'" (click)="setTab('gdpr')">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
            </svg>
            GDPR & Law 09-08
        </button>
    </div>

    <!-- Access Logs -->
    <div class="data-table" *ngIf="activeTab === 'logs'">
        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Action</th>
                    <th>IP Address</th>
                    <th>Date & Time</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let log of accessLogs">
                    <td>{{ log.user }}</td>
                    <td>{{ log.action }}</td>
                    <td><code>{{ log.ip }}</code></td>
                    <td>{{ log.date | date:'medium' }}</td>
                    <td><span class="status-badge" [ngClass]="getStatusClass(log.status)">{{ log.status }}</span></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Patient Access -->
    <div class="data-table" *ngIf="activeTab === 'patient-access'">
        <table>
            <thead>
                <tr>
                    <th>Patient</th>
                    <th>Accessed By</th>
                    <th>Reason</th>
                    <th>Date & Time</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let access of patientAccesses">
                    <td>{{ access.patientName }}</td>
                    <td>{{ access.accessedBy }}</td>
                    <td>{{ access.reason }}</td>
                    <td>{{ access.date | date:'medium' }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- GDPR -->
    <div class="gdpr-section" *ngIf="activeTab === 'gdpr'">
        <div class="compliance-card">
            <h3>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
                GDPR Compliance
            </h3>
            <ul>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Data encryption at rest and in transit</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Right to access personal data</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Right to data portability</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Right to be forgotten (data deletion)</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Consent management</li>
            </ul>
        </div>
        <div class="compliance-card">
            <h3>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                    <polyline points="14 2 14 8 20 8" />
                </svg>
                Law 09-08 (Morocco)
            </h3>
            <ul>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> CNDP registration</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Patient consent for data processing</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Data retention policies</li>
                <li><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="#20c997" stroke-width="2">
                        <polyline points="20 6 9 17 4 12" />
                    </svg> Security incident reporting</li>
            </ul>
        </div>
        <div class="compliance-card">
            <h3>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="20" x2="18" y2="10" />
                    <line x1="12" y1="20" x2="12" y2="4" />
                    <line x1="6" y1="20" x2="6" y2="14" />
                </svg>
                Quick Stats
            </h3>
            <div class="stat-row"><span>Total logins (30 days):</span><strong>1,256</strong></div>
            <div class="stat-row"><span>Failed attempts:</span><strong>23</strong></div>
            <div class="stat-row"><span>Patient records accessed:</span><strong>4,521</strong></div>
            <div class="stat-row"><span>Data export requests:</span><strong>12</strong></div>
        </div>
    </div>
</div>